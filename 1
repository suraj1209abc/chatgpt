-- Create the main ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "DarkThemeGui"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Create the main frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 400, 0, 350)
mainFrame.Position = UDim2.new(0.5, -200, 0.5, -175)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30) -- Dark theme background
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- Add a title label
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Size = UDim2.new(1, 0, 0, 50)
titleLabel.Position = UDim2.new(0, 0, 0, 0)
titleLabel.BackgroundColor3 = Color3.fromRGB(45, 45, 45) -- Slightly lighter for contrast
titleLabel.BorderSizePixel = 0
titleLabel.Text = "Admin UI"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextSize = 24
titleLabel.Parent = mainFrame

-- Create a draggable toggle button
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0, 100, 0, 50)
toggleButton.Position = UDim2.new(0.05, 0, 0.05, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
toggleButton.Text = "Toggle UI"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.SourceSansBold
toggleButton.TextSize = 18
toggleButton.Parent = screenGui

local dragging = false
local dragInput, dragStart, startPos

toggleButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = toggleButton.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

toggleButton.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        toggleButton.Position = UDim2.new(
            startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y
        )
    end
end)

-- Toggle the main frame visibility
toggleButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
end)

-- Create a close button
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -40, 0, 10)
closeButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Font = Enum.Font.SourceSansBold
closeButton.TextSize = 18
closeButton.Parent = mainFrame

closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Variables for flying
local UIS = game:GetService("UserInputService")
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

local flying = false
local speed = 50
local direction = Vector3.zero

local function startFlying()
    flying = true
    humanoid.PlatformStand = true
    
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(1, 1, 1) * math.huge
    bodyVelocity.Velocity = Vector3.zero
    bodyVelocity.Name = "FlyVelocity"
    bodyVelocity.Parent = rootPart

    local bodyGyro = Instance.new("BodyGyro")
    bodyGyro.MaxTorque = Vector3.new(1, 1, 1) * math.huge
    bodyGyro.CFrame = rootPart.CFrame
    bodyGyro.Name = "FlyGyro"
    bodyGyro.Parent = rootPart
end

local function stopFlying()
    flying = false
    humanoid.PlatformStand = false

    local velocity = rootPart:FindFirstChild("FlyVelocity")
    if velocity then velocity:Destroy() end

    local gyro = rootPart:FindFirstChild("FlyGyro")
    if gyro then gyro:Destroy() end
end

-- Toggle fly when key is pressed
UIS.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    if input.KeyCode == Enum.KeyCode.F then
        if flying then
            stopFlying()
        else
            startFlying()
        end
    end
end)

-- Update fly movement
game:GetService("RunService").RenderStepped:Connect(function()
    if flying then
        local velocity = rootPart:FindFirstChild("FlyVelocity")
        if velocity then
            velocity.Velocity = direction * speed
        end
    end
end)

-- Handle movement input
UIS.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    if input.KeyCode == Enum.KeyCode.W then
        direction = Vector3.new(0, 0, -1)
    elseif input.KeyCode == Enum.KeyCode.S then
        direction = Vector3.new(0, 0, 1)
    elseif input.KeyCode == Enum.KeyCode.A then
        direction = Vector3.new(-1, 0, 0)
    elseif input.KeyCode == Enum.KeyCode.D then
        direction = Vector3.new(1, 0, 0)
    elseif input.KeyCode == Enum.KeyCode.Space then
        direction = Vector3.new(0, 1, 0)
    elseif input.KeyCode == Enum.KeyCode.LeftControl then
        direction = Vector3.new(0, -1, 0)
    end
end)

UIS.InputEnded:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.W or
       input.KeyCode == Enum.KeyCode.S or
       input.KeyCode == Enum.KeyCode.A or
       input.KeyCode == Enum.KeyCode.D or
       input.KeyCode == Enum.KeyCode.Space or
       input.KeyCode == Enum.KeyCode.LeftControl then
        direction = Vector3.zero
    end
end)

-- Speed adjustment toggle and slider
local speedToggle = Instance.new("TextButton")
speedToggle.Name = "SpeedToggle"
speedToggle.Size = UDim2.new(0, 380, 0, 30)
speedToggle.Position = UDim2.new(0, 10, 0, 60)
speedToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
speedToggle.Text = "Speed (Toggle: OFF)"
speedToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
speedToggle.Font = Enum.Font.SourceSans
speedToggle.TextSize = 18
speedToggle.Parent = mainFrame

local speedEnabled = false
speedToggle.MouseButton1Click:Connect(function()
    speedEnabled = not speedEnabled
    speedToggle.Text = "Speed (Toggle: " .. (speedEnabled and "ON" or "OFF") .. ")"
    if not speedEnabled then
        humanoid.WalkSpeed = 16 -- Reset to default speed
    end
end)

local speedSlider = Instance.new("TextLabel")
speedSlider.Name = "SpeedSlider"
speedSlider.Size = UDim2.new(0, 380, 0, 30)
speedSlider.Position = UDim2.new(0, 10, 0, 100)
speedSlider.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
speedSlider.Text = "Adjust Speed (Scroll)"
speedSlider.TextColor3 = Color3.fromRGB(200, 200, 200)
speedSlider.Font = Enum.Font.SourceSans
speedSlider.TextSize = 16
speedSlider.Parent = mainFrame

local scrollConnection
speedSlider.MouseEnter:Connect(function()
    scrollConnection = UIS.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseWheel then
            if speedEnabled then
                humanoid.WalkSpeed = math.clamp(humanoid.WalkSpeed + input.Position.Z, 16, 100)
                speedSlider.Text = "Speed: " .. tostring(humanoid.WalkSpeed)
            end
        end
    end)
end)

speedSlider.MouseLeave:Connect(function()
    if scrollConnection then
        scrollConnection:Disconnect()
        scrollConnection = nil
        speedSlider.Text = "Adjust Speed (Scroll)"
    end
end)

-- Auto-collect coins toggle
local autoCollectToggle = Instance.new("TextButton")
autoCollectToggle.Name = "AutoCollectToggle"
autoCollectToggle.Size = UDim2.new(0, 380, 0, 30)
autoCollectToggle.Position = UDim2.new(0, 10, 0, 140)
autoCollectToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
autoCollectToggle.Text = "Auto Collect Coins (Toggle: OFF)"
autoCollectToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
autoCollectToggle.Font = Enum.Font.SourceSans
autoCollectToggle.TextSize = 18
autoCollectToggle.Parent = mainFrame

local autoCollectEnabled = false
local function collectCoins()
    while autoCollectEnabled do
        for _, coin in pairs(workspace:GetDescendants()) do
            if coin:IsA("BasePart") and coin.Name == "Coin" then
                local distance = (coin.Position - rootPart.Position).Magnitude
                if distance > 5 then
                    local flyVelocity = rootPart:FindFirstChild("FlyVelocity")
                    if flyVelocity then
                        flyVelocity.Velocity = (coin.Position - rootPart.Position).Unit * speed
                    end
                else
                    rootPart.CFrame = CFrame.new(coin.Position)
                end
                wait(0.1)
            end
        end
        wait(0.5)
    end
end

autoCollectToggle.MouseButton1Click:Connect(function()
    autoCollectEnabled = not autoCollectEnabled
    autoCollectToggle.Text = "Auto Collect Coins (Toggle: " .. (autoCollectEnabled and "ON" or "OFF") .. ")"
    if autoCollectEnabled then
        startFlying()
        collectCoins()
        stopFlying()
    end
end)

-- Add a credits label
local creditsLabel = Instance.new("TextLabel")
creditsLabel.Name = "CreditsLabel"
creditsLabel.Size = UDim2.new(1, 0, 0, 30)
creditsLabel.Position = UDim2.new(0, 0, 1, -30)
creditsLabel.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
creditsLabel.BorderSizePixel = 0
creditsLabel.Text = "Made by Sukii"
creditsLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
creditsLabel.Font = Enum.Font.SourceSansItalic
creditsLabel.TextSize = 16
creditsLabel.Parent = mainFrame
